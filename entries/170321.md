# 17th March 2021

## TODOs from last meeting



## What I've done

### Matching the MAF distribution of the whole SNP set in the ind. subset

We want to downsample the independent SNPs so that their distribution matches that of the whole set of SNPs. In the matching scheme you suggested, the size `n` of the largest (down)sample we can draw depends on the minimum of  `absoluteFreq.ind / relativeFreq.whole` across all bins. For a given bin we can't sample more independent SNPs than there are in the bin to begin with: `n * relativeFreq.whole <= absoluteFreq.ind`.

For my MAF bins I selected breaks `(0, 0.01], (0.01, 0.02], ..., (0.49, 0.5]`. An approach to bin width selection would be to use the Freedman-Draconis rule (`2*IQR/n^(1/3)`): this gives breaks `(0,0.02], (0.02, 0.04], ...`. There was little difference in the maximum sample size I got with each, so I went with the first.

I was able to draw a sample of ~427k independent SNPs with the matched distribution using a T1D data set (chosen as it is the only one with MAF data to hand). Compare this figure with the 1.2M independent SNPs (and 4.35M dependent SNPs) in the original data set. 

I looked at the density of SNPs over the genome in both the independent subset and the downsampled set.

![](/images/170321/t1d_matched_maf_independentSNPs_only_density_chr1_11.png)
![](/images/170321/t1d_matched_maf_independentSNPs_only_density_chr12_22.png)

Seems pretty even. 

We expect the shape of the downsampled subset histogram to match that of the whole set, and it does:

![](/images/170321/downsampling_histograms.png)

Lastly, the results of `fcfdr` run using the matched independent subset. 

![](/images/170321/t1d_matched_maf.png)
